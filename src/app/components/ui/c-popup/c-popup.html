<div class="c-popup">
  @switch (dialogData.mode) {

  @case ('create') {
  <h1 mat-dialog-title class="c-popup__title">Create {{ dialogData.title || 'Item' }}</h1>

  <mat-dialog-content class="c-popup__content">
    <form class="c-popup__form" [formGroup]="form">
      @for (key of formKeys; track key) {
      @if (form.contains(key)) {
      <mat-form-field appearance="fill" class="c-popup__form-field">
        <mat-label>{{ key }}</mat-label>
        @if (dialogData.fieldOptions && dialogData.fieldOptions[key]) {
        <mat-select [formControlName]="key">
          @for (option of dialogData.fieldOptions[key]; track option) {
          <mat-option [value]="option">{{ option }}</mat-option>
          }
        </mat-select>
        } @else {
        <input matInput [formControlName]="key" [type]="key === 'price' ? 'number' : 'text'"
          [min]="key === 'price' ? 0 : null">
        }
      </mat-form-field>
      }
      }
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="c-popup__actions">
    <button mat-button (click)="onClose()" class="c-popup__button">Cancel</button>
    <button mat-raised-button color="primary" (click)="onSave()" [disabled]="form.invalid"
      class="c-popup__button c-popup__button--primary">
      Create
    </button>
  </mat-dialog-actions>
  }

  @case ('edit') {
  <h1 mat-dialog-title class="c-popup__title">Edit {{ dialogData.title || 'Item' }}</h1>

  <mat-dialog-content class="c-popup__content">
    <form class="c-popup__form" [formGroup]="form">
      @for (key of formKeys; track key) {
      @if (form.contains(key)) {
      <mat-form-field appearance="fill" class="c-popup__form-field">
        <mat-label>{{ key }}</mat-label>
        @if (dialogData.fieldOptions && dialogData.fieldOptions[key]) {
        <mat-select [formControlName]="key">
          @for (option of dialogData.fieldOptions[key]; track option) {
          <mat-option [value]="option">{{ option }}</mat-option>
          }
        </mat-select>
        } @else {
        <input matInput [formControlName]="key" [type]="key === 'price' ? 'number' : 'text'"
          [min]="key === 'price' ? 0 : null">
        }
      </mat-form-field>
      }
      }
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="c-popup__actions">
    <button mat-button (click)="onClose()" class="c-popup__button">Cancel</button>
    <button mat-raised-button color="primary" (click)="onSave()" [disabled]="form.invalid"
      class="c-popup__button c-popup__button--primary">
      Save
    </button>
  </mat-dialog-actions>
  }

  @case ('delete') {
  <h1 mat-dialog-title class="c-popup__title c-popup__title--danger">Delete {{ dialogData.title || 'Item' }}</h1>

  <mat-dialog-content class="c-popup__content">
    <p>Are you sure you want to delete this {{ dialogData.title?.toLowerCase() || 'item' }}? This action cannot be
      undone.</p>

    @for (key of formKeys; track key) {
    <p class="c-popup__data-row">
      <strong class="c-popup__data-key">{{ key }}:</strong>
      {{ dialogData.data[key] }}
    </p>
    }
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="c-popup__actions">
    <button mat-button (click)="onClose()" class="c-popup__button">Cancel</button>
    <button mat-raised-button color="warn" (click)="onDelete()" class="c-popup__button c-popup__button--warn">
      Delete
    </button>
  </mat-dialog-actions>
  }

  }
</div>