<div class="pc-admin">
  @if (isLoading()) {
  <div class="loading">
    <div class="loader"></div>
    <p>CONECTANDO AL SISTEMA...</p>
  </div>
  } @else if (error()) {
  <div class="error-state">
    <div class="error-icon">SYSTEM ERROR</div>
    <h2>{{ error() }}</h2>
    <button class="c-btn" (click)="goBack()">REGRESAR AL MAPA</button>
  </div>
  } @else if (booking()) {
  <header class="pc-admin__header">
    <button class="back-btn" (click)="goBack()">
      < VOLVER </button>
        <div class="header-info">
          <h1>{{ booking()!.pc.label }}</h1>
          <span class="category-badge">{{ booking()!.pc.categoryPCResponse.label }}</span>
        </div>
        <div class="header-actions">
          <button class="c-btn c-btn--danger" [routerLink]="['/pc-admin', booking()!.pc.id, 'report']">
            REPORTAR INCIDENCIA
          </button>
        </div>
        <div class="status-indicator online">
          <span class="dot"></span>
          EN LÍNEA
        </div>
  </header>

  <main class="pc-admin__content">
    <!-- Tiempo restante destacado -->
    <section class="time-section">
      <div class="time-card active">
        <div class="time-label">TIEMPO ACTIVO</div>
        <div class="time-value">{{ calculateUptime() }}</div>
      </div>
      <div class="time-card remaining">
        <div class="time-label">TIEMPO RESTANTE</div>
        <div class="time-value">{{ getRemainingTime() }}</div>
        <div class="time-bar">
          <div class="time-progress" [style.width.%]="getRemainingPercentage()"></div>
        </div>
      </div>
      <div class="time-card total">
        <div class="time-label">SESIÓN TOTAL</div>
        <div class="time-value">{{ booking()!.hours }}H</div>
      </div>
    </section>

    <!-- Specs del PC -->
    <section class="specs-section">
      @let specs = getParsedSpecs(booking()!.pc.specs);
      <div class="specs-grid">
        <div class="spec-item">
          <div class="spec-icon">[CPU]</div>
          <div class="spec-info">
            <span class="spec-label">PROCESADOR</span>
            <span class="spec-value">{{ specs.cpu }}</span>
          </div>
        </div>
        <div class="spec-item">
          <div class="spec-icon">[GPU]</div>
          <div class="spec-info">
            <span class="spec-label">GRÁFICA</span>
            <span class="spec-value">{{ specs.gpu }}</span>
          </div>
        </div>
        <div class="spec-item">
          <div class="spec-icon">[RAM]</div>
          <div class="spec-info">
            <span class="spec-label">MEMORIA</span>
            <span class="spec-value">{{ specs.ram }}</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Estadísticas en tiempo real -->
    @if (pcStats()) {
    <section class="stats-section">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-icon">[PWR]</span>
            <span class="stat-name">CARGA CPU</span>
            <span class="stat-percentage">{{ pcStats()!.cpuUsage }}%</span>
          </div>
          <div class="stat-bar">
            <div class="stat-fill cpu" [style.width.%]="pcStats()!.cpuUsage"></div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-icon">[MEM]</span>
            <span class="stat-name">USO RAM</span>
            <span class="stat-percentage">{{ pcStats()!.ramUsage }}GB / {{ pcStats()!.ramTotal }}GB</span>
          </div>
          <div class="stat-bar">
            <div class="stat-fill ram" [style.width.%]="(pcStats()!.ramUsage / pcStats()!.ramTotal) * 100"></div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-icon">[GFX]</span>
            <span class="stat-name">CARGA GPU</span>
            <span class="stat-percentage">{{ pcStats()!.gpuUsage }}%</span>
          </div>
          <div class="stat-bar">
            <div class="stat-fill gpu" [style.width.%]="pcStats()!.gpuUsage"></div>
          </div>
          <div class="stat-extra">
            <span>TEMP: {{ pcStats()!.gpuTemp }}°C</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-icon">[IO]</span>
            <span class="stat-name">DISCO</span>
            <span class="stat-percentage">{{ pcStats()!.diskUsage }}%</span>
          </div>
          <div class="stat-bar">
            <div class="stat-fill disk" [style.width.%]="pcStats()!.diskUsage"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Network y procesos -->
    <section class="network-section">
      <div class="network-grid">
        <div class="network-card">
          <div class="network-icon up">UP</div>
          <div class="network-info">
            <span class="network-label">SUBIDA</span>
            <span class="network-value">{{ pcStats()!.networkUp }} <small>MBPS</small></span>
          </div>
        </div>
        <div class="network-card">
          <div class="network-icon down">DN</div>
          <div class="network-info">
            <span class="network-label">BAJADA</span>
            <span class="network-value">{{ pcStats()!.networkDown }} <small>MBPS</small></span>
          </div>
        </div>
        <div class="network-card">
          <div class="network-icon process">SYS</div>
          <div class="network-info">
            <span class="network-label">PROCESOS</span>
            <span class="network-value">{{ pcStats()!.activeProcesses }}</span>
          </div>
        </div>
        <div class="network-card">
          <div class="network-icon uptime">RUN</div>
          <div class="network-info">
            <span class="network-label">UPTIME</span>
            <span class="network-value">{{ pcStats()!.uptime }}</span>
          </div>
        </div>
      </div>
    </section>
    }
  </main>
  }
</div>